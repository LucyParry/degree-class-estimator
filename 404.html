<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Single Page Apps for GitHub Pages</title>
    <script type="text/javascript">

        // This script based upon 'Single Page Apps for GitHub Pages' Copyright (c) 2016 Rafael Pedicini, licensed under the MIT License
        // Available at: https://github.com/rafrex/spa-github-pages
        // with modification for learning purposes
        // ------------------------------------------------------------------------------------------------------------------------------
        // In brief the script takes the current the URL, and converts the route part to a query string
        // (e.g. https://www.example.com/about/examplepage?var1=hello&var2=world#anchor
        // becomes: https://www.example.com/?route=/about/examplepage&query=var1=hello~and~var2=world#anchor )
        // The request is redirected to the new URL (which will be a request for the default page e.g.index.html), containing
        // the new query string, which can be passed to the single page application to render the correct page.

        // There may be more segments in the URL that refer to the directory rather than a route. GitHub Project Pages for example uses 
        // the repo name, e.g. https://username.github.io/repo-name/ so 'segmentCount' can be set as required so we preserve this and
        // don't treat it as part of the route
        // ------------------------------------------------------------------------------------------------------------------------------
        var segmentCount = 1;

        // first get the current full url, and extract the protocal, host and port
        var location = window.location;
        var newPath = location.protocol + '//' + location.hostname + (location.port === '' ? location.port : ':' + location.port);

        // add any segments that are not actually for routing in the application as described above
        newPath += location.pathname.split('/').slice(0, 1 + segmentCount).join('/')

        // take the actual route part and convert it to a query string (replacing any ampersands)
        newPath += '/?route=/' + location.pathname.slice(1).split('/').slice(segmentCount).join('/').replace(/&/g, '~and~')

        // add the 'real' query string if present and any # anchor
        newPath += (location.search ? '&query=' + location.search.slice(1).replace(/&/g, '~and~') : '') + location.hash

        console.log(newPath);
        // finally redirect to to the new URL
        location.replace(newPath);

    </script>
</head>
<body>
</body>
</html>
